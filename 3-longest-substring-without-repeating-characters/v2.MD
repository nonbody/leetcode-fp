```ts
const isCharExist = (target: string, longest: string[]): boolean =>
    longest.includes(target);

const shiftUntilFound = (target: string, longest: string[]): void => {
    const shift = longest.shift();
    if (target !== shift) {
        shiftUntilFound(target, longest);
    }
};

const shift = (
    isShift: boolean,
    target: string,
    longest: string[],
    max: number,
): [string, number] => {
    if (isShift) {
        max = longest.length > max ? longest.length : max;
        shiftUntilFound(target, longest);
    }
    return [target, max];
};

// leetcode provided func type
const lengthOfLongestSubstring = (s: string): number => {
    const longest: string[] = [];
    let max = 0;

    for (let i = 0; i < s.length; i++) {
        const first = s[i];
        const [needAppend, currentMax] = shift(
            isCharExist(first, longest),
            first,
            longest,
            max,
        );
        max = currentMax;
        longest.push(needAppend);
    }
    const currentMax = longest.length;
    return currentMax > max ? currentMax : max;
};
```